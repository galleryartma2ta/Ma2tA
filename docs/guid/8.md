**راهنمای جامع دیباگ پروژه Ma2tA**

---

### **۱. دیباگ بک‌اند (Go + Gin)**

#### **الف) استفاده از لاگ‌های سرور**
- **فعال‌سازی لاگ‌های دقیق در Gin:**
  ```go
  func main() {
      // حالت دیباگ
      gin.SetMode(gin.DebugMode)
      r := gin.Default()
      
      // افزودن لاگ‌های درخواست
      r.Use(gin.Logger())
  }
  ```
  - لاگ‌ها در کنسول نمایش داده می‌شوند.

#### **ب) استفاده از Delve (دیباگر Go)**
1. **نصب Delve:**
   ```bash
   go install github.com/go-delve/delve/cmd/dlv@latest
   ```

2. **اجرای سرور در حالت دیباگ:**
   ```bash
   dlv debug cmd/main.go
   ```

3. **دستورات رایج:**
   - `break main.go:20`: نقطه توقف در خط ۲۰
   - `continue`: ادامه اجرا
   - `print variable`: چاپ مقدار متغیر

#### **ج) تست Endpointها با Postman/curl**
- **مثال خطای ۵۰۰:**
  ```bash
  curl -v http://localhost:8080/api/v1/buggy-endpoint
  ```
  - بررسی لاگ‌های سرور برای جزئیات خطا.

---

### **۲. دیباگ فرانت‌اند (SvelteKit + Vite)**

#### **الف) ابزارهای توسعه مرورگر**
- **Chrome DevTools:**
  - **Elements:** بررسی DOM و استایل‌ها
  - **Console:** مشاهده خطاهای جاوااسکریپت
  - **Network:** بررسی درخواست‌های HTTP
  - **Sources:** دیباگ کد با Breakpoint

#### **ب) لاگ‌های Vite**
- **مشاهده خطاهای کامپایل:**
  - خطاها به صورت زنده در ترمینال و مرورگر نمایش داده می‌شوند.

#### **ج) استفاده از `debugger` در کد**
```javascript
function addToCart(product) {
    debugger; // اجرا متوقف می‌شود
    // منطق افزودن به سبد
}
```

#### **د) دیباگ State با Redux DevTools**
- **نصب افزونه:** [Redux DevTools](https://chrome.google.com/webstore/detail/redux-devtools)
- **پیاده‌سازی در استور Svelte:**
  ```javascript
  import { writable } from 'svelte/store';
  export const cart = writable([], () => {
      window.__REDUX_DEVTOOLS_EXTENSION__?.connect()
  });
  ```

---

### **۳. دیباگ اپ موبایل (Flutter)**

#### **الف) دیباگ در VS Code**
1. **تنظیم Launch Configuration (`launch.json`):**
   ```json
   {
       "version": "0.2.0",
       "configurations": [
           {
               "name": "Ma2tA Mobile",
               "request": "launch",
               "type": "dart"
           }
       ]
   }
   ```

2. **Breakpoint زدن:**  
   کلیک روی حاشیه خط مورد نظر در VS Code.

#### **ب) استفاده از `print` و `debugPrint`**
```dart
void fetchProducts() async {
    try {
        debugPrint('Fetching products...'); // فقط در حالت دیباگ
        var products = await ApiService.getProducts();
    } catch (e) {
        print('Error: $e'); // همیشه چاپ می‌شود
    }
}
```

#### **ج) ابزارهای توسعه Flutter**
- **Widget Inspector:** بررسی درخت ویجت‌ها
- **Performance Overlay:** تحلیل عملکرد اپ
  ```dart
  void main() {
      debugPaintSizeEnabled = true; // فعال‌سازی هنگام نیاز
      runApp(const MyApp());
  }
  ```

---

### **۴. دیباگ در محیط Docker**

#### **الف) مشاهده لاگ‌های کانتینر**
```bash
docker-compose logs -f backend
```

#### **ب) ورود به کانتینر برای بررسی**
```bash
docker exec -it ma2ta-backend bash
cd /app
ls -la
```

#### **ج) تست شبکه بین کانتینرها**
```bash
docker exec ma2ta-backend curl http://frontend:3000
```

---

### **۵. خطاهای رایج و راه‌حل‌ها**

#### **الف) خطای `CORS` در API**
- **علت:** درخواست از دامنه غیرمجاز
- **راه‌حل:**  
  ```go
  // middleware/cors.go
  c.Writer.Header().Set("Access-Control-Allow-Origin", "*")
  ```

#### **ب) خطای `Database is locked` در SQLite**
- **علت:** دسترسی همزمان چندین فرایند
- **راه‌حل:**  
  ```go
  db.SetMaxOpenConns(1) // فقط در توسعه
  ```

#### **ج) خطای `Null Safety` در Flutter**
- **علت:** استفاده از متغیرهای nullable بدون بررسی
- **راه‌حل:**  
  ```dart
  if (product != null) {
      // منطق
  }
  ```

---

### **۶. ابزارهای پیشرفته دیباگ**

| ابزار               | کاربرد                          | لینک                           |
|----------------------|----------------------------------|--------------------------------|
| **Sentry**           | رصد خطاهای زنده                 | [sentry.io](https://sentry.io) |
| **Wireshark**        | تحلیل ترافیک شبکه               | [wireshark.org](https://www.wireshark.org) |
| **Charles Proxy**    | دیباگ درخواست‌های HTTP/HTTPS    | [charlesproxy.com](https://www.charlesproxy.com) |

---

**نکات نهایی:**  
- همیشه از **ورژن‌های پایدار** کتابخانه‌ها استفاده کنید.  
- قبل از دیباگ، مطمئن شوید کدتان را **Commit** کرده‌اید.  
- از **تست‌های واحد** برای پیشگیری از خطاها استفاده کنید.  

اگر همچنان مشکل دارید، لاگ‌ها و کد مرتبط را در **[Issues گیتهاب](https://github.com/yourusername/Ma2tA/issues)** منتشر کنید! 🐞🔧