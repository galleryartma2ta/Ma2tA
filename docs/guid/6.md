**راهنمای کامل اجرای پروژه Ma2tA (گام ۶):**

---

### **۱. اجرای بک‌اند (Go + Gin)**
#### **مراحل:**
1. **ورود به پوشه بک‌اند:**
   ```bash
   cd backend
   ```

2. **نصب وابستگی‌های Go:**
   ```bash
   go mod tidy
   ```

3. **اجرای سرور:**
   ```bash
   go run cmd/main.go
   ```

4. **اعتبارسنجی:**
   - سرور روی `http://localhost:8080` اجرا می‌شود.
   - تست سلامت (Health Check):
     ```bash
     curl http://localhost:8080/api/v1/health
     ```
     خروجی موفق: `{"status":"ok"}`

---

### **۲. اجرای فرانت‌اند (SvelteKit + Tailwind)**
#### **مراحل:**
1. **ورود به پوشه فرانت‌اند:**
   ```bash
   cd frontend
   ```

2. **نصب وابستگی‌های npm:**
   ```bash
   npm install
   ```

3. **اجرای سرور توسعه:**
   ```bash
   npm run dev
   ```

4. **اعتبارسنجی:**
   - مرورگر را باز کنید و به `http://localhost:3000` بروید.
   - باید صفحه اصلی فروشگاه را ببینید.

---

### **۳. اجرای اپ موبایل (Flutter)**
#### **مراحل:**
1. **ورود به پوشه موبایل:**
   ```bash
   cd mobile
   ```

2. **نصب وابستگی‌ها:**
   ```bash
   flutter pub get
   ```

3. **اجرای اپ روی شبیه‌ساز یا دستگاه:**
   - **اندروید (شبیه‌ساز):**
     ```bash
     flutter emulators --launch Pixel_5_API_33
     flutter run -d emulator-5554
     ```
   - **iOS (Xcode):**
     ```bash
     open -a Simulator
     flutter run -d iPhone_14_Pro_Max
     ```
   - **دستگاه واقعی (USB Debugging):**
     ```bash
     flutter run -d <device_id>
     ```

---

### **۴. اجرای پروژه با Docker Compose**
#### **مراحل:**
1. **اجرای تمام سرویس‌ها با یک دستور:**
   ```bash
   docker-compose up -d --build
   ```

2. **بررسی وضعیت کانتینرها:**
   ```bash
   docker-compose ps
   ```
   خروجی نمونه:
   ```
   NAME                STATUS              PORTS
   ma2ta-backend       Up 2 minutes        0.0.0.0:8080->8080/tcp
   ma2ta-frontend      Up 2 minutes        0.0.0.0:3000->3000/tcp
   ma2ta-redis         Up 2 minutes        0.0.0.0:6379->6379/tcp
   ```

3. **توقف سرویس‌ها:**
   ```bash
   docker-compose down
   ```

---

### **۵. تست End-to-End**
#### **تست API با Postman:**
1. **دریافت لیست محصولات:**
   - **Method:** `GET`  
   - **URL:** `http://localhost:8080/api/v1/products`

2. **ایجاد محصول جدید:**
   - **Method:** `POST`  
   - **URL:** `http://localhost:8080/api/v1/products`  
   - **Body (JSON):**
     ```json
     {
       "name": "لپ‌تاپ",
       "price": 25000000,
       "stock": 10
     }
     ```

#### **تست پرداخت زرین‌پال:**
1. **شروع تراکنش:**
   - **Method:** `POST`  
   - **URL:** `http://localhost:8080/api/v1/payment`  
   - **Body (JSON):**
     ```json
     {
       "amount": 100000,
       "description": "خرید محصول"
     }
     ```
   - **خروجی:** لینک درگاه پرداخت زرین‌پال.

---

### **مشکلات رایج و راه‌حل‌ها**
#### **۱. خطای `Port already in use`**
- **علت:** پورت ۸۰۸۰ یا ۳۰۰۰ توسط برنامه دیگری استفاده می‌شود.
- **راه‌حل:**  
  - برنامه‌های مزاحم را ببندید (مثلاً VS Code Live Server).
  - یا پورت را در `docker-compose.yml` تغییر دهید:
    ```yaml
    ports:
      - "8081:8080"  # پورت جدید: 8081
    ```

#### **۲. خطای `Connection refused` در فرانت‌اند**
- **علت:** بک‌اند اجرا نشده یا آدرس API نادرست است.
- **راه‌حل:**  
  - مطمئن شوید بک‌اند در حال اجراست.
  - در فایل `.env` فرانت‌اند آدرس API را بررسی کنید.

#### **۳. خطای `Missing dependencies` در Flutter**
- **علت:** پکیج‌ها به درستی نصب نشده‌اند.
- **راه‌حل:**  
  ```bash
  flutter pub cache repair
  flutter clean
  flutter pub get
  ```

---

### **نکات پیشرفته**
#### **۱. اجرای پروژه در محیط تولید (Production)**
- **بک‌اند:**
  ```bash
  GIN_MODE=release go run cmd/main.go
  ```
- **فرانت‌اند:**
  ```bash
  npm run build
  npm run preview
  ```

#### **۲. استفاده از Reverse Proxy (Nginx)**
- **کانفیگ نمونه (`nginx.conf`):**
  ```nginx
  server {
      listen 80;
      server_name ma2ta.com;

      location / {
          proxy_pass http://frontend:3000;
      }

      location /api {
          proxy_pass http://backend:8080;
      }
  }
  ```

#### **۳. مانیتورینگ با Prometheus + Grafana**
- **افزودن به `docker-compose.yml`:**
  ```yaml
  prometheus:
    image: prom/prometheus
    ports:
      - "9090:9090"
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml

  grafana:
    image: grafana/grafana
    ports:
      - "3001:3000"
  ```

---

**پایان!**  
اگر مشکلی داشتید، لاگ‌ها را بررسی کنید یا از طریق **[Issues گیتهاب](https://github.com/yourusername/Ma2tA/issues)** گزارش دهید! 🚀